<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Taylor Diagram - Professional Style</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: #f5f5f5;
            padding: 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #1C4587 0%, #2E5C8A 100%);
            color: white;
            padding: 25px;
            text-align: center;
        }

        .header h1 {
            font-size: 2em;
            margin-bottom: 8px;
        }

        .header p {
            opacity: 0.95;
            font-size: 1.05em;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 380px;
            gap: 0;
        }

        .diagram-section {
            padding: 30px;
            background: white;
            border-right: 2px solid #e0e0e0;
        }

        .controls-section {
            padding: 25px;
            background: #fafafa;
            max-height: 850px;
            overflow-y: auto;
        }

        canvas {
            background: white;
            border: 2px solid black;
            border-radius: 4px;
            cursor: crosshair;
        }

        .tab-buttons {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            border-bottom: 2px solid #ddd;
        }

        .tab-button {
            flex: 1;
            padding: 12px;
            border: none;
            background: transparent;
            color: #666;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s;
        }

        .tab-button.active {
            color: #1C4587;
            border-bottom-color: #1C4587;
            background: white;
        }

        .tab-button:hover:not(.active) {
            color: #2E5C8A;
            background: #f0f0f0;
        }

        .input-group {
            margin-bottom: 18px;
        }

        .input-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: #333;
            font-size: 13px;
        }

        .input-group input[type="text"] {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        .input-group input[type="text"]:focus {
            outline: none;
            border-color: #1C4587;
        }

        .input-group input[type="range"] {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: #ddd;
            outline: none;
        }

        .input-group input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #1C4587;
            cursor: pointer;
        }

        .input-group input[type="range"]::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #1C4587;
            cursor: pointer;
            border: none;
        }

        .color-input {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .color-input input[type="color"] {
            width: 50px;
            height: 40px;
            border: 2px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
        }

        .button {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 4px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
        }

        .button-primary {
            background: #1C4587;
            color: white;
        }

        .button-primary:hover {
            background: #2E5C8A;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(28, 69, 135, 0.3);
        }

        .button-danger {
            background: #d32f2f;
            color: white;
            margin-top: 10px;
        }

        .button-danger:hover {
            background: #b71c1c;
        }

        .marker-select {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            background: white;
        }

        .marker-select:focus {
            outline: none;
            border-color: #1C4587;
        }

        .model-list {
            margin-top: 20px;
        }

        .model-item {
            background: white;
            padding: 12px;
            border-radius: 4px;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid #ddd;
        }

        .model-info {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .model-marker {
            width: 24px;
            height: 24px;
            border: 2px solid black;
            border-radius: 2px;
        }

        .model-name {
            font-weight: 600;
            color: #333;
            font-size: 13px;
        }

        .model-stats {
            font-size: 11px;
            color: #666;
            margin-top: 3px;
        }

        .delete-btn {
            background: #d32f2f;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
            font-weight: 600;
        }

        .delete-btn:hover {
            background: #b71c1c;
        }

        .example-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-bottom: 18px;
        }

        .example-btn {
            padding: 10px;
            border: 2px solid #1C4587;
            background: white;
            color: #1C4587;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            font-size: 12px;
            transition: all 0.3s;
        }

        .example-btn:hover {
            background: #1C4587;
            color: white;
        }

        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #1976D2;
            padding: 12px;
            border-radius: 4px;
            margin-bottom: 18px;
            font-size: 13px;
            line-height: 1.5;
        }

        .stats-box {
            background: #f5f5f5;
            padding: 12px;
            border-radius: 4px;
            border: 1px solid #ddd;
            font-size: 12px;
            font-family: 'Courier New', monospace;
        }

        .stats-box strong {
            color: #1C4587;
        }

        .legend {
            background: #fafafa;
            padding: 15px;
            border-radius: 4px;
            margin-top: 20px;
            border: 1px solid #ddd;
        }

        .legend-title {
            font-weight: 700;
            margin-bottom: 12px;
            color: #333;
            font-size: 13px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            font-size: 12px;
        }

        .legend-line {
            width: 30px;
            height: 2px;
            margin-right: 10px;
        }

        .legend-symbol {
            width: 20px;
            height: 20px;
            margin-right: 10px;
            border: 2px solid black;
        }

        .controls-toggle {
            display: flex;
            gap: 15px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .toggle-label {
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            font-size: 12px;
            color: #555;
        }

        .toggle-label input[type="checkbox"] {
            width: 16px;
            height: 16px;
            cursor: pointer;
        }

        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .diagram-section {
                border-right: none;
                border-bottom: 2px solid #e0e0e0;
            }
            
            .controls-section {
                max-height: none;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect } = React;

        function TaylorDiagramTool() {
            const canvasRef = useRef(null);
            const [activeTab, setActiveTab] = useState('add');
            const [models, setModels] = useState([]);
            const [currentModel, setCurrentModel] = useState({
                name: '',
                correlation: 0.8,
                sdr: 1.0,  // Standard Deviation Ratio
                color: '#6FA8DC',
                marker: 'circle'
            });
            const [showRMSD, setShowRMSD] = useState(true);
            const [showCorrelationLines, setShowCorrelationLines] = useState(true);
            const [showGrid, setShowGrid] = useState(true);

            const CANVAS_SIZE = 700;
            const CENTER_X = CANVAS_SIZE / 2;
            const CENTER_Y = CANVAS_SIZE / 2;
            const RADIUS = 240;
            const MAX_SDR = 1.3;  // Maximum SDR on axis

            useEffect(() => {
                drawDiagram();
            }, [models, showRMSD, showCorrelationLines, showGrid]);

            const drawDiagram = () => {
                const canvas = canvasRef.current;
                if (!canvas) return;

                const ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, CANVAS_SIZE, CANVAS_SIZE);

                // White background
                ctx.fillStyle = '#ffffff';
                ctx.fillRect(0, 0, CANVAS_SIZE, CANVAS_SIZE);

                // Draw elements in order
                if (showGrid) {
                    drawGrid(ctx);
                }

                if (showCorrelationLines) {
                    drawCorrelationLines(ctx);
                }

                drawSDRCircles(ctx);

                if (showRMSD) {
                    drawRMSDContours(ctx);
                }

                drawAxes(ctx);
                drawReferencePoint(ctx);

                models.forEach(model => {
                    drawModelPoint(ctx, model);
                });

                drawAxisLabels(ctx);
            };

            const drawGrid = (ctx) => {
                ctx.strokeStyle = 'rgba(0, 0, 0, 0.15)';
                ctx.lineWidth = 0.5;
                ctx.setLineDash([2, 2]);

                // Radial grid lines
                const sdrValues = [0.25, 0.5, 0.75, 1.0, 1.25];
                sdrValues.forEach(sdr => {
                    const radius = (sdr / MAX_SDR) * RADIUS;
                    ctx.beginPath();
                    ctx.arc(CENTER_X, CENTER_Y, radius, Math.PI, 0, true);
                    ctx.stroke();
                });

                // Angular grid lines
                const correlations = [0.2, 0.4, 0.6, 0.8, 0.9];
                correlations.forEach(corr => {
                    const angle = Math.acos(corr);
                    const endX = CENTER_X + RADIUS * 1.2 * Math.cos(angle);
                    const endY = CENTER_Y - RADIUS * 1.2 * Math.sin(angle);
                    ctx.beginPath();
                    ctx.moveTo(CENTER_X, CENTER_Y);
                    ctx.lineTo(endX, endY);
                    ctx.stroke();
                });

                ctx.setLineDash([]);
            };

            const drawCorrelationLines = (ctx) => {
                const correlations = [0.2, 0.4, 0.6, 0.7, 0.8, 0.9, 0.95, 0.99];
                
                ctx.strokeStyle = 'rgba(100, 149, 237, 0.3)';
                ctx.lineWidth = 1;
                ctx.setLineDash([5, 5]);

                correlations.forEach(corr => {
                    const angle = Math.acos(corr);
                    const endX = CENTER_X + RADIUS * 1.15 * Math.cos(angle);
                    const endY = CENTER_Y - RADIUS * 1.15 * Math.sin(angle);

                    ctx.beginPath();
                    ctx.moveTo(CENTER_X, CENTER_Y);
                    ctx.lineTo(endX, endY);
                    ctx.stroke();
                });

                ctx.setLineDash([]);
            };

            const drawSDRCircles = (ctx) => {
                const sdrValues = [0.25, 0.5, 0.75, 1.0, 1.25];
                
                ctx.strokeStyle = '#000000';
                ctx.lineWidth = 1.2;

                sdrValues.forEach(sdr => {
                    const radius = (sdr / MAX_SDR) * RADIUS;
                    ctx.beginPath();
                    ctx.arc(CENTER_X, CENTER_Y, radius, Math.PI, 0, true);
                    ctx.stroke();

                    // Labels on right side
                    ctx.fillStyle = '#000000';
                    ctx.font = 'bold 11px Arial';
                    ctx.textAlign = 'left';
                    ctx.fillText(sdr.toFixed(2), CENTER_X + radius + 8, CENTER_Y + 5);
                });
            };

            const drawRMSDContours = (ctx) => {
                const refX = CENTER_X + RADIUS * (1.0 / MAX_SDR);
                const refY = CENTER_Y;
                const rmsdLevels = [0.2, 0.4, 0.6, 0.8, 1.0];

                ctx.strokeStyle = '#32CD32';  // Lime green
                ctx.lineWidth = 1.3;
                ctx.setLineDash([4, 4]);

                rmsdLevels.forEach(rmsd => {
                    const radius = (rmsd / MAX_SDR) * RADIUS;
                    ctx.beginPath();
                    ctx.arc(refX, refY, radius, Math.PI / 2, 3 * Math.PI / 2, false);
                    ctx.stroke();

                    // Label
                    const labelX = refX - radius * 0.7;
                    const labelY = refY - radius * 0.7;
                    ctx.fillStyle = '#32CD32';
                    ctx.font = 'bold 10px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText(rmsd.toFixed(1), labelX, labelY);
                });

                ctx.setLineDash([]);
            };

            const drawAxes = (ctx) => {
                // Horizontal axis
                ctx.strokeStyle = '#000000';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(CENTER_X, CENTER_Y);
                ctx.lineTo(CENTER_X + RADIUS * 1.25, CENTER_Y);
                ctx.stroke();

                // Vertical semicircle arc
                ctx.beginPath();
                ctx.arc(CENTER_X, CENTER_Y, RADIUS * 1.15, Math.PI, 0, true);
                ctx.stroke();

                // Correlation ticks and labels (blue)
                const correlations = [0, 0.2, 0.4, 0.6, 0.7, 0.8, 0.9, 0.95, 0.99];
                correlations.forEach(corr => {
                    const angle = Math.acos(corr);
                    const x = CENTER_X + RADIUS * 1.15 * Math.cos(angle);
                    const y = CENTER_Y - RADIUS * 1.15 * Math.sin(angle);

                    // Tick mark
                    const tickX = CENTER_X + RADIUS * 1.18 * Math.cos(angle);
                    const tickY = CENTER_Y - RADIUS * 1.18 * Math.sin(angle);
                    ctx.beginPath();
                    ctx.moveTo(x, y);
                    ctx.lineTo(tickX, tickY);
                    ctx.lineWidth = 1.5;
                    ctx.stroke();

                    // Label
                    const labelX = CENTER_X + RADIUS * 1.28 * Math.cos(angle);
                    const labelY = CENTER_Y - RADIUS * 1.28 * Math.sin(angle);
                    ctx.fillStyle = 'royalblue';
                    ctx.font = 'bold 10px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText(corr.toFixed(2), labelX, labelY);
                });
            };

            const drawReferencePoint = (ctx) => {
                const refX = CENTER_X + RADIUS * (1.0 / MAX_SDR);
                const refY = CENTER_Y;

                // Black star
                drawStar(ctx, refX, refY, 14, '#000000', '#000000');

                // Reference line
                ctx.strokeStyle = '#000000';
                ctx.lineWidth = 1.2;
                ctx.setLineDash([5, 5]);
                ctx.beginPath();
                const t = [];
                for (let i = 0; i <= 100; i++) {
                    t.push((Math.PI * i) / 100);
                }
                t.forEach((angle, i) => {
                    const x = CENTER_X + RADIUS * (1.0 / MAX_SDR) * Math.cos(angle);
                    const y = CENTER_Y - RADIUS * (1.0 / MAX_SDR) * Math.sin(angle);
                    if (i === 0) ctx.moveTo(x, y);
                    else ctx.lineTo(x, y);
                });
                ctx.stroke();
                ctx.setLineDash([]);

                // Label
                ctx.fillStyle = '#000000';
                ctx.font = 'bold 12px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('Observed', refX, refY - 20);
            };

            const drawModelPoint = (ctx, model) => {
                const angle = Math.acos(Math.max(0, Math.min(1, model.correlation)));
                const x = CENTER_X + (model.sdr / MAX_SDR) * RADIUS * Math.cos(angle);
                const y = CENTER_Y - (model.sdr / MAX_SDR) * RADIUS * Math.sin(angle);

                // Draw marker
                if (model.marker === 'circle') {
                    ctx.beginPath();
                    ctx.arc(x, y, 7, 0, 2 * Math.PI);
                    ctx.fillStyle = model.color;
                    ctx.fill();
                    ctx.strokeStyle = '#000000';
                    ctx.lineWidth = 1.5;
                    ctx.stroke();
                } else if (model.marker === 'triangle') {
                    drawTriangle(ctx, x, y, 14, model.color);
                } else if (model.marker === 'square') {
                    ctx.fillStyle = model.color;
                    ctx.strokeStyle = '#000000';
                    ctx.lineWidth = 1.5;
                    ctx.fillRect(x - 7, y - 7, 14, 14);
                    ctx.strokeRect(x - 7, y - 7, 14, 14);
                } else if (model.marker === 'diamond') {
                    drawDiamond(ctx, x, y, 14, model.color);
                }

                // Label
                ctx.fillStyle = '#000000';
                ctx.font = 'bold 11px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(model.name, x, y - 14);
            };

            const drawStar = (ctx, x, y, size, fillColor, strokeColor) => {
                ctx.save();
                ctx.translate(x, y);
                ctx.beginPath();
                for (let i = 0; i < 5; i++) {
                    const angle = (i * 4 * Math.PI) / 5 - Math.PI / 2;
                    const radius = i % 2 === 0 ? size : size / 2.5;
                    const px = radius * Math.cos(angle);
                    const py = radius * Math.sin(angle);
                    if (i === 0) ctx.moveTo(px, py);
                    else ctx.lineTo(px, py);
                }
                ctx.closePath();
                ctx.fillStyle = fillColor;
                ctx.fill();
                ctx.strokeStyle = strokeColor;
                ctx.lineWidth = 1.5;
                ctx.stroke();
                ctx.restore();
            };

            const drawTriangle = (ctx, x, y, size, color) => {
                ctx.beginPath();
                ctx.moveTo(x, y - size / 2);
                ctx.lineTo(x - size / 2, y + size / 2);
                ctx.lineTo(x + size / 2, y + size / 2);
                ctx.closePath();
                ctx.fillStyle = color;
                ctx.fill();
                ctx.strokeStyle = '#000000';
                ctx.lineWidth = 1.5;
                ctx.stroke();
            };

            const drawDiamond = (ctx, x, y, size, color) => {
                ctx.beginPath();
                ctx.moveTo(x, y - size / 2);
                ctx.lineTo(x + size / 2, y);
                ctx.lineTo(x, y + size / 2);
                ctx.lineTo(x - size / 2, y);
                ctx.closePath();
                ctx.fillStyle = color;
                ctx.fill();
                ctx.strokeStyle = '#000000';
                ctx.lineWidth = 1.5;
                ctx.stroke();
            };

            const drawAxisLabels = (ctx) => {
                // Top: Correlation Coefficient (blue, bold)
                ctx.fillStyle = 'royalblue';
                ctx.font = 'bold 14px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('Correlation Coefficient', CENTER_X, CENTER_Y - RADIUS * 1.42);

                // Right: SDR (black, bold)
                ctx.save();
                ctx.translate(CENTER_X + RADIUS * 1.35, CENTER_Y - RADIUS * 0.4);
                ctx.rotate(-Math.PI / 2);
                ctx.fillStyle = '#000000';
                ctx.font = 'bold 14px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('Standard Deviation Ratio (SDR)', 0, 0);
                ctx.restore();

                // Bottom: Normalized RMSD (green, bold)
                if (showRMSD) {
                    ctx.fillStyle = '#32CD32';
                    ctx.font = 'bold 14px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText('Normalized RMSD', CENTER_X, CENTER_Y + RADIUS * 0.5);
                }
            };

            const calculateRMSD = (corr, sdr) => {
                return Math.sqrt(1 + sdr * sdr - 2 * sdr * corr);
            };

            const addModel = () => {
                if (currentModel.name.trim() === '') {
                    alert('Please enter a model name');
                    return;
                }

                const rmsd = calculateRMSD(currentModel.correlation, currentModel.sdr);
                
                setModels([...models, {
                    ...currentModel,
                    rmsd: rmsd
                }]);

                setCurrentModel({
                    name: '',
                    correlation: 0.8,
                    sdr: 1.0,
                    color: '#6FA8DC',
                    marker: 'circle'
                });
            };

            const deleteModel = (index) => {
                setModels(models.filter((_, i) => i !== index));
            };

            const loadExample = (exampleType) => {
                let exampleModels = [];

                if (exampleType === 'mhhw') {
                    exampleModels = [
                        { name: 'Uncorrected', correlation: 0.85, sdr: 1.12, color: '#6FA8DC', marker: 'circle' },
                        { name: 'Bias-Corrected', correlation: 0.93, sdr: 1.02, color: '#1C4587', marker: 'triangle' }
                    ];
                } else if (exampleType === 'gt') {
                    exampleModels = [
                        { name: 'Uncorrected', correlation: 0.78, sdr: 1.18, color: '#6FA8DC', marker: 'circle' },
                        { name: 'Bias-Corrected', correlation: 0.91, sdr: 0.98, color: '#1C4587', marker: 'triangle' }
                    ];
                } else if (exampleType === 'climate') {
                    exampleModels = [
                        { name: 'Model A', correlation: 0.92, sdr: 1.05, color: '#2196F3', marker: 'circle' },
                        { name: 'Model B', correlation: 0.88, sdr: 0.95, color: '#4CAF50', marker: 'triangle' },
                        { name: 'Model C', correlation: 0.82, sdr: 1.15, color: '#FF9800', marker: 'square' },
                        { name: 'Model D', correlation: 0.75, sdr: 0.90, color: '#9C27B0', marker: 'diamond' }
                    ];
                } else if (exampleType === 'ml') {
                    exampleModels = [
                        { name: 'CNN', correlation: 0.88, sdr: 1.02, color: '#E91E63', marker: 'circle' },
                        { name: 'LSTM', correlation: 0.82, sdr: 0.98, color: '#00BCD4', marker: 'triangle' },
                        { name: 'RF', correlation: 0.75, sdr: 0.92, color: '#8BC34A', marker: 'square' },
                        { name: 'Linear', correlation: 0.68, sdr: 0.88, color: '#FF5722', marker: 'diamond' }
                    ];
                }

                setModels(exampleModels.map(m => ({
                    ...m,
                    rmsd: calculateRMSD(m.correlation, m.sdr)
                })));
            };

            const handleCanvasClick = (e) => {
                const canvas = canvasRef.current;
                const rect = canvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;

                const dx = x - CENTER_X;
                const dy = y - CENTER_Y;
                const distance = Math.sqrt(dx * dx + dy * dy);

                if (distance <= RADIUS && dy <= 0) {
                    const angle = Math.atan2(-dy, dx);
                    const correlation = Math.cos(angle);
                    const sdr = (distance / RADIUS) * MAX_SDR;

                    if (correlation >= 0 && correlation <= 1 && sdr >= 0 && sdr <= MAX_SDR) {
                        setCurrentModel({
                            ...currentModel,
                            correlation: parseFloat(correlation.toFixed(3)),
                            sdr: parseFloat(sdr.toFixed(3))
                        });
                        setActiveTab('add');
                    }
                }
            };

            return (
                <div className="container">
                    <div className="header">
                        <h1>üìä Interactive Taylor Diagram</h1>
                        <p>Professional single-quadrant Taylor diagram matching matplotlib style</p>
                    </div>

                    <div className="main-content">
                        <div className="diagram-section">
                            <canvas
                                ref={canvasRef}
                                width={CANVAS_SIZE}
                                height={CANVAS_SIZE}
                                onClick={handleCanvasClick}
                            />

                            <div className="legend">
                                <div className="legend-title">Display Controls</div>
                                <div className="controls-toggle">
                                    <label className="toggle-label">
                                        <input 
                                            type="checkbox" 
                                            checked={showRMSD}
                                            onChange={(e) => setShowRMSD(e.target.checked)}
                                        />
                                        <span>RMSD Contours</span>
                                    </label>
                                    <label className="toggle-label">
                                        <input 
                                            type="checkbox" 
                                            checked={showCorrelationLines}
                                            onChange={(e) => setShowCorrelationLines(e.target.checked)}
                                        />
                                        <span>Correlation Lines</span>
                                    </label>
                                    <label className="toggle-label">
                                        <input 
                                            type="checkbox" 
                                            checked={showGrid}
                                            onChange={(e) => setShowGrid(e.target.checked)}
                                        />
                                        <span>Grid Lines</span>
                                    </label>
                                </div>

                                <div style={{marginTop: '15px'}}>
                                    <div className="legend-title">Legend</div>
                                    <div className="legend-item">
                                        <div className="legend-symbol" style={{background: '#000000', clipPath: 'polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%)'}}></div>
                                        <span>Observed (Reference)</span>
                                    </div>
                                    <div className="legend-item">
                                        <div className="legend-line" style={{background: '#000000', height: '2px'}}></div>
                                        <span>SDR Circles</span>
                                    </div>
                                    <div className="legend-item">
                                        <div className="legend-line" style={{background: 'royalblue', height: '2px', borderTop: '2px dashed royalblue'}}></div>
                                        <span>Correlation Lines</span>
                                    </div>
                                    <div className="legend-item">
                                        <div className="legend-line" style={{background: '#32CD32', height: '2px', borderTop: '2px dashed #32CD32'}}></div>
                                        <span>Normalized RMSD</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div className="controls-section">
                            <div className="tab-buttons">
                                <button 
                                    className={`tab-button ${activeTab === 'add' ? 'active' : ''}`}
                                    onClick={() => setActiveTab('add')}
                                >
                                    Add Model
                                </button>
                                <button 
                                    className={`tab-button ${activeTab === 'examples' ? 'active' : ''}`}
                                    onClick={() => setActiveTab('examples')}
                                >
                                    Examples
                                </button>
                            </div>

                            {activeTab === 'add' && (
                                <div>
                                    <div className="info-box">
                                        üí° <strong>Click on the diagram</strong> to set values, or use controls below
                                    </div>

                                    <div className="input-group">
                                        <label>Model Name</label>
                                        <input
                                            type="text"
                                            value={currentModel.name}
                                            onChange={(e) => setCurrentModel({...currentModel, name: e.target.value})}
                                            placeholder="e.g., Uncorrected, CNN, etc."
                                        />
                                    </div>

                                    <div className="input-group">
                                        <label>Correlation: {currentModel.correlation.toFixed(3)}</label>
                                        <input
                                            type="range"
                                            min="0"
                                            max="1"
                                            step="0.01"
                                            value={currentModel.correlation}
                                            onChange={(e) => setCurrentModel({...currentModel, correlation: parseFloat(e.target.value)})}
                                        />
                                    </div>

                                    <div className="input-group">
                                        <label>SDR (œÉ/œÉ_ref): {currentModel.sdr.toFixed(3)}</label>
                                        <input
                                            type="range"
                                            min="0"
                                            max="1.5"
                                            step="0.01"
                                            value={currentModel.sdr}
                                            onChange={(e) => setCurrentModel({...currentModel, sdr: parseFloat(e.target.value)})}
                                        />
                                    </div>

                                    <div className="input-group">
                                        <label>Marker Type</label>
                                        <select 
                                            className="marker-select"
                                            value={currentModel.marker}
                                            onChange={(e) => setCurrentModel({...currentModel, marker: e.target.value})}
                                        >
                                            <option value="circle">Circle (‚óè)</option>
                                            <option value="triangle">Triangle (‚ñ≤)</option>
                                            <option value="square">Square (‚ñ†)</option>
                                            <option value="diamond">Diamond (‚óÜ)</option>
                                        </select>
                                    </div>

                                    <div className="input-group">
                                        <label>Color</label>
                                        <div className="color-input">
                                            <input
                                                type="color"
                                                value={currentModel.color}
                                                onChange={(e) => setCurrentModel({...currentModel, color: e.target.value})}
                                            />
                                            <span style={{fontSize: '12px', color: '#666'}}>{currentModel.color}</span>
                                        </div>
                                    </div>

                                    <div className="stats-box">
                                        <strong>Normalized RMSD:</strong> {calculateRMSD(currentModel.correlation, currentModel.sdr).toFixed(3)}
                                    </div>

                                    <button className="button button-primary" onClick={addModel}>
                                        Add Model to Diagram
                                    </button>

                                    {models.length > 0 && (
                                        <button 
                                            className="button button-danger" 
                                            onClick={() => setModels([])}
                                        >
                                            Clear All Models
                                        </button>
                                    )}

                                    <div className="model-list">
                                        <h3 style={{marginBottom: '12px', color: '#333', fontSize: '14px', fontWeight: '700'}}>
                                            Current Models ({models.length})
                                        </h3>
                                        {models.map((model, index) => (
                                            <div key={index} className="model-item">
                                                <div className="model-info">
                                                    <div 
                                                        className="model-marker" 
                                                        style={{
                                                            backgroundColor: model.color,
                                                            clipPath: model.marker === 'triangle' ? 'polygon(50% 0%, 0% 100%, 100% 100%)' :
                                                                     model.marker === 'diamond' ? 'polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%)' :
                                                                     model.marker === 'square' ? 'none' : 'circle(50%)'
                                                        }}
                                                    ></div>
                                                    <div>
                                                        <div className="model-name">{model.name}</div>
                                                        <div className="model-stats">
                                                            r: {model.correlation.toFixed(3)} | 
                                                            SDR: {model.sdr.toFixed(3)} | 
                                                            RMSD: {model.rmsd.toFixed(3)}
                                                        </div>
                                                    </div>
                                                </div>
                                                <button 
                                                    className="delete-btn"
                                                    onClick={() => deleteModel(index)}
                                                >
                                                    Delete
                                                </button>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}

                            {activeTab === 'examples' && (
                                <div>
                                    <div className="info-box">
                                        Load pre-configured examples based on your Python code style
                                    </div>

                                    <div className="example-buttons">
                                        <button className="example-btn" onClick={() => loadExample('mhhw')}>
                                            üåä MHHW Example
                                        </button>
                                        <button className="example-btn" onClick={() => loadExample('gt')}>
                                            üìä GT Example
                                        </button>
                                        <button className="example-btn" onClick={() => loadExample('climate')}>
                                            üåç Climate Models
                                        </button>
                                        <button className="example-btn" onClick={() => loadExample('ml')}>
                                            ü§ñ ML Comparison
                                        </button>
                                    </div>

                                    <div className="info-box" style={{background: '#fff3cd', borderLeft: '4px solid #ffc107'}}>
                                        <strong>MHHW Example:</strong> Mean Higher High Water comparison - uncorrected vs bias-corrected<br/><br/>
                                        <strong>GT Example:</strong> Great Diurnal Range comparison - uncorrected vs bias-corrected<br/><br/>
                                        <strong>Climate Models:</strong> Multi-model comparison with different markers<br/><br/>
                                        <strong>ML Comparison:</strong> Machine learning model performance comparison
                                    </div>

                                    <div className="info-box" style={{background: '#e8f5e9', borderLeft: '4px solid #4CAF50'}}>
                                        <strong>üìö Key Concepts:</strong><br/><br/>
                                        <strong>SDR (Standard Deviation Ratio):</strong> œÉ_model / œÉ_observed<br/>
                                        ‚Ä¢ SDR = 1.0: Perfect variance match<br/>
                                        ‚Ä¢ SDR &gt; 1.0: Model overestimates variability<br/>
                                        ‚Ä¢ SDR &lt; 1.0: Model underestimates variability<br/><br/>
                                        
                                        <strong>Normalized RMSD:</strong><br/>
                                        RMSD¬≤ = 1 + SDR¬≤ - 2¬∑SDR¬∑r<br/><br/>
                                        
                                        <strong>Perfect Model:</strong> At reference point with r=1.0, SDR=1.0, RMSD=0.0
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<TaylorDiagramTool />, document.getElementById('root'));
    </script>
</body>
</html>
